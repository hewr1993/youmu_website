<!DOCTYPE html>
<html class="no-js" lang="en" ng-app="youmuApp">
    <head lang="en">
        <title>视频点播页</title>
        {% include 'partials/head.html' %}
        <link href="/static/video-js/video-js.css" rel="stylesheet">
        <script src="/static/video-js/video.js"></script>
        <script src="/static/js/CommentCoreLibrary/CommentCoreLibrary.js"></script>
        <script src="/static/js/CommentCoreLibrary/BilibiliFormat.js"></script>
        <link href="/static/css/videojs_ABdm.css" rel="stylesheet">
        <script src="/static/js/videojs_ABdm.js"></script>
        <script src="/static/js/vendor/jquery.js"></script>
        <link href="/static/fonts/foundation-icons.css" rel="stylesheet">
		<script>
			$(document).ready(function(){
				window.thevideojs = videojs("playbox");
				thevideojs.ABP();
				thevideojs.danmu.load("/static/comment.xml");
			});
		</script>
    </head>
    <body class="video">
        <div class="main">
            {% include 'partials/topbar.html' %}
            <div ng-controller="videoDataCtrl">
                <div class="row">
                    <input type="hidden" value="{{ video_id }}" id="video_id"/>
                    <h1>{{video.title}}</h1>
                    <video id="playbox" class="video-js vjs-default-skin" controls preload="auto" poster="{{video.cover == '' ? 'http://placehold.it/1000x1000&amp;text=Thumbnail' : video.cover}}" data-setup='{}' width="100%">
                        <source src="" id="playboxUrl" type="video/mp4" />
                        <p class="vjs-no-js">
                            To view this video please enable JavaScript, and consider upgrading to a web browser
                            that <a href="http://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a>
                        </p>
                    </video>
                    <script>
                        $("#playboxUrl").attr("src", "http://" + document.domain + ":8888/" + $("#video_id").val());
                    </script>
                </div>

                <div class="row">
                    <div class="video-data">
                        <a href="#" class="small-4 columns uploader">
                            <span class="label">上传人</span>
                            <span class="data">{{video.owner_name}}</span>
                        </a>
                        <a class="small-4 columns likes-count" ng-click="likeVideo()">
                            <span class="label">点赞</span>
                            <span class="data">{{video.like}}</span>
                            <span class="data" ng-show="melike">（您赞过了）</span>
                        </a>
                        <div class="small-4 columns views-count">
                            <span class="label">观看</span>
                            <span class="data">{{video.play_count}}</span>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <fieldset>
                        <legend>视频信息</legend>
                        <div class="medium-3 large-2 columns time">{{video.upload_time | date}}</div>
                        <div class="medium-9 large-10 columns description">{{video.description}}</div>
                    </fieldset>
                </div>

                <!--div class="row">
                    <div class="comments">
                    <ul class="comments-list">
                    <li class="comment-item">
                    <div class="author"><a href='/u/ampersand'>ampersand</a></div>
                    <div class="time">2014/10/30 6:32 AM</div>
                    <div class="content">
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                    </div>
                    </li>
                    </ul>
                    </div>
                    </div-->

                    <div class="row">
                        <fieldset>
                            <legend>评论</legend>
                            <div class="comments">
                                <ul class="comments-list" ng-repeat="comment in comments | orderBy: 'floor'">
                                    <li class="comment-item">
                                        <div class="row">
                                            <div class="small-1 columns author">
                                                <i class="fi-x" 
                                                   ng-show="comment.user_id == user_id" 
                                                   ng-click="delComment(comment.comment_id)"
                                                   style="cursor:pointer;">
                                                </i>
                                                <a href="#">{{comment.user_name}}</a>
                                            </div>
                                            <div class="small-9 columns content">
                                                {{comment.content}}
                                            </div>
                                            <div class="small-2 columns time">
                                                {{comment.reply_time}}&nbsp;
                                                <span class="round secondary label">{{comment.floor}}</span>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                                <form class="custom" id="commentForm" data-abide="ajax">
                                    <textarea id="commentContent" placeholder="请输入你的评论..."></textarea>
                                    <button type="submit" id="commentButton">评论</button>
                                </form>
                            </div>
                        </fieldset>
                    </div>
        </div>
        </div>

    </body>
    {% include 'partials/foot.html' %}
</html>
